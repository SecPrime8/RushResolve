# Product Requirements Document (PRD)
# Windows Tech Toolkit

**Version:** 2.0
**Author:** Optimized Primate
**Date:** January 2026
**Status:** Active Development

---

## Executive Summary

Windows Tech Toolkit is a modular, portable PowerShell-based application designed for IT professionals who regularly deploy, troubleshoot, and maintain Windows workstations. The toolkit consolidates common IT tasks into a single, extensible GUI application that can run from a USB drive without installation.

### Problem Statement

IT technicians performing workstation deployment and troubleshooting face several pain points:

1. **Tool Fragmentation** - Common tasks require switching between multiple utilities (Device Manager, Network Connections, Command Prompt, various vendor tools)
2. **Repetitive Manual Steps** - Tasks like silent software installation, printer setup, and domain rejoins require remembering specific commands and switches
3. **Inconsistent Processes** - Without standardized tooling, different technicians approach problems differently, leading to inconsistent outcomes
4. **Time Waste** - Navigating Windows UI for routine tasks adds up across hundreds of workstation touches
5. **Knowledge Silos** - Tribal knowledge about common fixes isn't captured in reusable form

### Solution

A single portable application that:
- Consolidates common IT tasks into a tabbed interface
- Automates repetitive workflows (batch software install, network resets, domain rejoin)
- Provides diagnostic information at a glance
- Is extensible via drop-in PowerShell modules
- Requires no installation (runs from USB/network share)
- Works offline (no cloud dependencies)

### Target Users

| Persona | Description | Primary Use Cases |
|---------|-------------|-------------------|
| **Field Technician** | Travels to client sites, deploys new machines, troubleshoots issues | Software deployment, printer setup, network diagnostics |
| **Help Desk Tech** | Remote/on-site support, handles tickets | Domain issues, network problems, disk cleanup |
| **System Administrator** | Manages fleet of workstations | Bulk operations, standardization, diagnostics |

---

## Current Implementation Status

### Completed (v2.0)

| Component | Status | Notes |
|-----------|--------|-------|
| Main Framework (`TechToolkit.ps1`) | DONE | Tabbed GUI, module loading, settings persistence |
| Credential Elevation System | DONE | `Get-ElevatedCredential`, `Invoke-Elevated`, `Start-ElevatedProcess` |
| Settings Management | DONE | JSON-based, per-module settings support |
| System Info Module | DONE | System info display, admin tool launchers, reboot/shutdown |
| Software Installer Module | DONE | Directory scanning, install.json configs, batch install |

### In Progress

| Component | Status | Notes |
|-----------|--------|-------|
| Tab visibility improvements | Testing | Tabs now 30px tall with proper spacing |
| Event handler scope fixes | Testing | Removed closures, using $script: scope |

### Planned (Not Started)

| Component | Priority | Notes |
|-----------|----------|-------|
| Printer Management Module | P0 | Add/remove network printers, clear queues |
| Network Tools Module | P1 | Ping, tracert, DNS flush, IP release/renew |
| Domain Tools Module | P1 | Trust relationship repair, domain rejoin |
| AD Tools Module | P2 | Password reset, group lookup, account unlock |
| Disk Cleanup Module | P2 | Temp files, browser cache, space analysis |

---

## Technical Architecture

### File Structure

```
projects/Rush_IT/RushResolveApp/
├── TechToolkit.ps1              # Main launcher (696 lines)
├── Config/
│   └── settings.json            # User settings persistence
├── Modules/
│   ├── 01_SystemInfo.ps1        # System info + admin tools
│   └── 02_SoftwareInstaller.ps1 # Batch software installation
├── Tools/                       # Standalone legacy scripts
│   ├── Add-Printer-GUI.ps1
│   ├── Check-Health-Report.ps1
│   ├── DomainRejoin.ps1
│   └── ... (9 scripts total)
├── docs/
│   └── module-template.md       # Developer guide
└── troubleshooting/
    └── *.png                    # Debug screenshots
```

### Module Interface Contract

All modules must implement:

```powershell
$script:ModuleName = "Display Name"
$script:ModuleDescription = "Tooltip description"

function Initialize-Module {
    param(
        [Parameter(Mandatory)]
        [System.Windows.Forms.TabPage]$tab
    )
    # Build UI and attach to $tab
}
```

### Key Technical Decisions

| Decision | Choice | Rationale |
|----------|--------|-----------|
| GUI Framework | Windows Forms | Built into Windows, no dependencies |
| Variable Scope | `$script:` everywhere | Avoids closure issues with event handlers |
| Config Format | JSON | Human-readable, PowerShell native support |
| Elevation | RunAs with credentials | Least-privilege, prompt when needed |
| Development | Linux → Git → Windows | Claude codes on Linux, test on Windows |

---

## Module: System Info (COMPLETE)

### Features

| Feature | Status |
|---------|--------|
| Computer name, manufacturer, model, serial | DONE |
| OS version, build, architecture | DONE |
| Domain/workgroup, trust status | DONE |
| CPU, RAM, uptime | DONE |
| Storage (all drives with free space) | DONE |
| Network adapters with IPs | DONE |
| Copy to clipboard | DONE |
| Quick launch: Device Manager, Task Manager, Event Viewer, Services, MSInfo32 | DONE |
| Reboot/Shutdown buttons | DONE |

### UI Layout

```
+----------------------------------------------------------+
| System Info                                               |
+----------------------------------------------------------+
| System Information                                        |
| ┌──────────────────────────────────────────────────────┐ |
| │ SYSTEM INFORMATION                                    │ |
| │ ======================================================│ |
| │ COMPUTER                                              │ |
| │ Computer Name:    DESKTOP-ABC123                      │ |
| │ Manufacturer:     LENOVO                              │ |
| │ Model:            81X3                                │ |
| │ Serial Number:    R91183NN                            │ |
| │ ...                                                   │ |
| └──────────────────────────────────────────────────────┘ |
|                                                           |
| [Refresh] [Copy] | [Device Mgr] [Task Mgr] [Events]...   |
|                                                           |
| [Reboot] [Shutdown]    Battery Report moved to module    |
+----------------------------------------------------------+
```

---

## Module: Software Installer (COMPLETE)

### Features

| Feature | Status |
|---------|--------|
| Source selector (Network/Local) | DONE |
| Browse for installer directory | DONE |
| Scan root for standalone .msi/.exe | DONE |
| Scan subfolders with optional install.json | DONE |
| ListView with checkboxes for multi-select | DONE |
| Silent/Interactive install mode toggle | DONE |
| Batch installation with elevation | DONE |
| Log output showing progress | DONE |
| View Details dialog | DONE |
| Settings persistence (last used paths) | DONE |

### install.json Schema

```json
{
  "name": "Application Name",
  "version": "1.0.0",
  "description": "What this app does",
  "installer": "setup.exe",
  "silentArgs": "/S /NORESTART",
  "interactiveArgs": "",
  "requiresElevation": true
}
```

### UI Layout

```
+----------------------------------------------------------+
| Software Installer                                        |
+----------------------------------------------------------+
| Source: [Local/USB Directory ▼] [Browse...] [Refresh]    |
|                                                           |
| Available Applications                                    |
| ┌──────────────────────────────────────────────────────┐ |
| │ [x] Epic Hyperspace      2024.1   Clinical app      │ |
| │ [ ] Badge Printer        1.0      Utilities         │ |
| │ [x] standalone.msi                (standalone)      │ |
| └──────────────────────────────────────────────────────┘ |
|                                                           |
| Install Mode: (•) Silent  ( ) Interactive                |
|                                                           |
| [Install Selected] [Select All] [Clear] [View Details]   |
|                                                           |
| Installation Log                                          |
| ┌──────────────────────────────────────────────────────┐ |
| │ [21:30:15] Installing Epic Hyperspace...             │ |
| │ [21:30:45] SUCCESS: Epic Hyperspace (exit code: 0)   │ |
| └──────────────────────────────────────────────────────┘ |
+----------------------------------------------------------+
```

---

## Credential Elevation System (COMPLETE)

### Available Functions

| Function | Purpose |
|----------|---------|
| `Get-ElevatedCredential` | Prompts for admin credentials, optional caching |
| `Invoke-Elevated` | Run PowerShell script block with credentials |
| `Start-ElevatedProcess` | Run executable with credentials |
| `Clear-CachedCredentials` | Clear in-memory credential cache |

### Usage Example

```powershell
# Run installer with elevation
$result = Start-ElevatedProcess -FilePath "msiexec.exe" `
    -ArgumentList "/i `"$installerPath`" /qn" `
    -Wait -Hidden `
    -OperationName "install MyApp"

if ($result.Success) {
    Write-Host "Installed successfully"
} else {
    Write-Host "Failed: $($result.Error)"
}
```

---

## Development Workflow

### Code → Test Cycle

```
Linux (Claude writes)     →    Git Push    →    Windows (Luis tests)
                                                      ↓
Linux (Claude fixes)      ←    Feedback    ←    Reports results
```

### Commands

**On Linux (Claude):**
```bash
# Edit files, then:
git add <files>
git commit -m "Description"
git push origin feature/rush-it-toolkit
```

**On Windows (Luis):**
```powershell
git pull origin feature/rush-it-toolkit
.\TechToolkit.ps1
```

### Branch

- **Feature branch:** `feature/rush-it-toolkit`
- **Main branch:** `main` (merge when stable)

---

## Module Development Guide

### Creating a New Module

1. Create `Modules/NN_ModuleName.ps1` (NN = sort order)
2. Define required variables and function:

```powershell
$script:ModuleName = "My Module"
$script:ModuleDescription = "What it does"

function Initialize-Module {
    param(
        [Parameter(Mandatory)]
        [System.Windows.Forms.TabPage]$tab
    )

    # Use $script: scope for all UI controls
    $script:myTextBox = New-Object System.Windows.Forms.TextBox
    # ... build UI ...

    # Event handlers - NO .GetNewClosure(), use $script: vars
    $myButton.Add_Click({
        $script:myTextBox.Text = "Updated"
    })

    $tab.Controls.Add($mainPanel)
}
```

### Key Rules

1. **Always use `$script:` scope** for controls referenced in event handlers
2. **Never use `.GetNewClosure()`** - it freezes variable values
3. **Use ASCII only** - no Unicode box-drawing characters
4. **Calculate values before hashtables** - no inline `if` statements

---

## Roadmap

### Phase 1: Core Platform - COMPLETE
- [x] Main application framework
- [x] Module loading system
- [x] Credential elevation helpers
- [x] Settings persistence
- [x] System Info module
- [x] Software Installer module

### Phase 2: Essential Modules - IN PROGRESS
- [ ] Printer Management module
- [ ] Network Diagnostics module
- [ ] Domain Tools module

### Phase 3: Extended Modules
- [ ] Disk Cleanup module
- [ ] AD Tools module (password reset, etc.)
- [ ] Remote Tools module

### Phase 4: Polish
- [ ] Error handling improvements
- [ ] Installer presets save/load
- [ ] Printer presets save/load
- [ ] Battery Report module

---

## Technical Specifications

| Spec | Value |
|------|-------|
| Platform | Windows PowerShell 5.1+ |
| UI Framework | System.Windows.Forms |
| Minimum Windows | Windows 10 1809+ |
| Dependencies | None (uses built-in components) |
| Portability | Single folder, USB/network share |
| Window Size | 900x700 minimum, resizable |

---

## Document History

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 0.1 | 2026-01-05 | Optimized Primate | Initial draft |
| 1.0 | 2026-01-05 | Optimized Primate | Complete PRD with all planned modules |
| 2.0 | 2026-01-05 | Keyla (Claude) | Updated to reflect actual implementation status |

---

*End of Document*
